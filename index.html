<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz App</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen flex items-center justify-center">
    <div class="bg-white shadow-2xl rounded-2xl p-8 max-w-xl w-full animate__animated animate__fadeIn">
      <div class="flex justify-between items-center mb-2">
        <h1 class="text-2xl font-bold text-blue-700">ðŸ§  Smart Quiz</h1>
        <div id="score-counter" class="text-sm text-gray-600 font-medium">Score: 0 | Q1 of N</div>
      </div><div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%;"></div>
  </div>

  <div id="quiz-box">
    <div class="flex justify-between items-center mb-2">
      <div id="question-container" class="text-lg font-medium"></div>
      <div id="timer" class="text-sm font-bold text-red-500"></div>
    </div>
    <ul id="options-container" class="space-y-3"></ul>
    <div id="explanation" class="hidden mt-4 p-4 bg-yellow-100 text-yellow-800 rounded-md text-sm"></div>
    <button id="next-btn" class="mt-6 w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition">Submit</button>
  </div>
  <div id="result-box" class="hidden mt-6 text-center text-xl font-semibold text-green-700"></div>
</div>

<script>
  let currentQuestion = 0;
  let score = 0;
  let selectedKey = null;
  let questions = [];
  let answered = false;
  let timer;
  let timeLeft = 30;

  fetch('./quiz.json')
    .then((res) => res.json())
    .then((data) => {
      questions = data;
      loadQuestion();
    });

  function updateCounter() {
    document.getElementById("score-counter").innerText = `Score: ${score} | Q${currentQuestion + 1} of ${questions.length}`;
    document.getElementById("progress-bar").style.width = `${((currentQuestion) / questions.length) * 100}%`;
  }

  function startTimer() {
    clearInterval(timer);
    timeLeft = 30;
    document.getElementById("timer").innerText = `${timeLeft}s`;

    timer = setInterval(() => {
      timeLeft--;
      document.getElementById("timer").innerText = `${timeLeft}s`;

      if (timeLeft <= 0) {
        clearInterval(timer);
        document.getElementById("timer").innerText = "â± Time's up!";
        document.getElementById("next-btn").click();
      }
    }, 1000);
  }

  function loadQuestion() {
    const q = questions[currentQuestion];
    document.getElementById("question-container").innerText = `Q${currentQuestion + 1}: ${q.question}`;
    const optionsContainer = document.getElementById("options-container");
    optionsContainer.innerHTML = "";
    selectedKey = null;
    answered = false;
    updateCounter();
    startTimer();

    const explanationBox = document.getElementById("explanation");
    explanationBox.classList.add("hidden");
    explanationBox.innerText = "";

    for (const key in q.options) {
      const li = document.createElement("li");
      li.innerHTML = `<button class="w-full text-left p-3 rounded-lg border border-gray-300 hover:bg-blue-50 transition" data-key="${key}"><strong>${key}.</strong> ${q.options[key]}</button>`;

      li.querySelector("button").addEventListener("click", () => {
        if (answered) return;
        document.querySelectorAll("#options-container button").forEach((el) =>
          el.classList.remove("bg-blue-100", "ring-2", "ring-blue-500")
        );
        li.querySelector("button").classList.add("bg-blue-100", "ring-2", "ring-blue-500");
        selectedKey = key;
      });

      optionsContainer.appendChild(li);
    }
  }

  document.getElementById("next-btn").addEventListener("click", () => {
    clearInterval(timer);
    const q = questions[currentQuestion];
    if (!answered) {
      const correctKey = q.answerKey;
      const explanation = q.explanation;

      document.querySelectorAll("#options-container button").forEach((btn) => {
        const key = btn.dataset.key;
        if (key === correctKey) {
          btn.classList.add("bg-green-100", "text-green-800");
        }
        if (key === selectedKey && key !== correctKey) {
          btn.classList.add("bg-red-100", "text-red-800");
        }
        btn.disabled = true;
      });

      if (selectedKey === correctKey) {
        score++;
      }

      const explanationBox = document.getElementById("explanation");
      explanationBox.classList.remove("hidden");
      explanationBox.classList.add("animate__animated", "animate__fadeInUp");
      explanationBox.innerText = `ðŸ“˜ Explanation: ${explanation}`;

      answered = true;
      document.getElementById("next-btn").innerText =
        currentQuestion === questions.length - 1 ? "Finish" : "Next";
    } else {
      currentQuestion++;
      if (currentQuestion < questions.length) {
        loadQuestion();
        document.getElementById("next-btn").innerText = "Submit";
      } else {
        document.getElementById("quiz-box").classList.add("hidden");
        const resultBox = document.getElementById("result-box");
        resultBox.classList.remove("hidden");
        resultBox.classList.add("animate__animated", "animate__fadeIn");
        resultBox.innerText = `ðŸŽ‰ You scored ${score} out of ${questions.length}`;
        document.getElementById("progress-bar").style.width = `100%`;
        if (score === questions.length) confetti();
      }
    }
  });

  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js');
    });
  }
</script>

  </body>
</html>